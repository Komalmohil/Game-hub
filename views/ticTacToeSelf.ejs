<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
   <link rel="stylesheet" href="/css/ticTacToe.css">
</head>
<body>
  <%- include('partials/header', { user: user }) %>
 <div class="main">
  <h2>Tic Tac Toe</h2>

  <div class="info" id="gameInfo">
    <p>Current Turn: <span id="currentPlayer">X</span></p>
  </div>

  <div class="board" id="board">
    <% for (let i = 0; i < 9; i++) { %>
      <div class="cell" data-index="<%= i %>"></div>
    <% } %>
  </div>

  <button class="btn" id="resetBtn">Reset Game</button>
</div>

<script>
  const board = document.getElementById('board');
  const cells = document.querySelectorAll('.cell');
  const currentPlayerEl = document.getElementById('currentPlayer');
  let currentPlayer = 'X';
  let gameState = Array(9).fill('');

  const winConditions = [
    [0,1,2],[3,4,5],[6,7,8],
    [0,3,6],[1,4,7],[2,5,8],
    [0,4,8],[2,4,6]
  ];

  function checkWin() {
    for (const [a,b,c] of winConditions) {
      if (gameState[a] && gameState[a] === gameState[b] && gameState[a] === gameState[c])
        return gameState[a];
    }
    return gameState.includes('') ? null : 'Draw';
  }

  function handleClick(e) {
    const idx = e.target.dataset.index;
    if (gameState[idx] !== '') return;
    gameState[idx] = currentPlayer;
    e.target.textContent = currentPlayer;

    const winner = checkWin();
    if (winner) {
      document.getElementById('gameInfo').innerHTML = winner === 'Draw'
        ? '<p>It\'s a draw!</p>'
        : `<p>Player ${winner} wins!</p>`;
      board.removeEventListener('click', handleClick);
    } else {
      currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
      currentPlayerEl.textContent = currentPlayer;
    }
  }

  board.addEventListener('click', handleClick);

  document.getElementById('resetBtn').addEventListener('click', () => {
    gameState.fill('');
    cells.forEach(cell => cell.textContent = '');
    currentPlayer = 'X';
    currentPlayerEl.textContent = currentPlayer;
    document.getElementById('gameInfo').innerHTML = '<p>Current Turn: <span id="currentPlayer">X</span></p>';
    board.addEventListener('click', handleClick);
  });
</script>

</body></html>